<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Đăng nhập - EventHub</title>
    <link th:href="@{/css/login-styles.css}" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
            rel="stylesheet" />
</head>
<body class="dark-theme">
<div class="container">
    <div class="login-container glass" th:if="${userRole == null}">
        <!-- Left Panel - Branding Area -->
        <div class="brand-section">
            <div class="logo">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="brand-name">
                <span>EventHub</span>
            </div>
            <h1>Đăng nhập</h1>
            <p class="brand-tagline">Chào mừng bạn quay trở lại hệ thống quản lý sự kiện</p>
        </div>

        <!-- Right Panel - Login Form -->
        <div class="form-container">
            <div class="form-title">Đăng nhập</div>
            <form class="login-form auth-form" th:action="@{/login}" th:object="${request}" method="post">
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user"></i>
                        Tên đăng nhập
                    </label>
                    <input
                            type="text"
                            id="username"
                            placeholder="Nhập tên"
                            required
                            th:field="*{username}"                    />
                    <div class="error-message"
                         th:id="'username-error'"
                         th:if="${usernameError}"
                         th:text="${usernameError}">
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock"></i>
                        Mật khẩu
                    </label>
                    <div class="password-input">
                        <input
                                type="password"
                                id="password"
                                placeholder="Nhập mật khẩu"
                                th:field="*{password}"
                                required
                        />
                        <button type="button" class="toggle-password" onclick="togglePassword()">
                            <i class="fas fa-eye" id="passwordIcon"></i>
                        </button>
                    </div>
                    <div class="error-message"
                         th:if="${passwordError}"
                         th:id="'password-error'"
                         th:text="${passwordError}">
                    </div>
                </div>

                <div class="form-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="remember" name="remember" th:checked="${remember}" />
                        <span class="checkmark"></span>
                        Ghi nhớ đăng nhập
                    </label>
                    <a th:href="@{/forgot-password}" class="forgot-link">Quên mật khẩu?</a>
                </div>

                <button type="submit" class="submit-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Đăng nhập
                </button>
            </form>

            <div class="register-link">
                <p>Chưa có tài khoản? <a href="register" class="register-btn">Đăng ký ngay</a></p>
            </div>
        </div>
    </div>

    <div class="dashboard" th:if="${userRole != null}">
        <nav>
            <ul>
                <li><a th:href="@{/home}">Trang chủ</a></li>
                <li th:if="${userRole == 'ADMIN'}"><a th:href="@{/admin-home}">Dashboard Admin</a></li>
                <li th:if="${userRole == 'USER'}"><a th:href="@{/customer-home}">Hồ sơ cá nhân</a></li>
                <li><a th:href="@{/logout}">Đăng xuất</a></li>
            </ul>
        </nav>

        <div class="welcome-message">
            <p th:switch="${userRole}">
                <span th:case="'ADMIN'">Chào mừng Admin đến với EventHub!</span>
                <span th:case="'USER'">Chào mừng Người dùng đến với EventHub!</span>
                <span th:case="*">Chào mừng bạn đến với EventHub!</span>
            </p>
        </div>


<!--        <div th:if="${userRole == 'ADMIN'}" class="admin-section">-->
<!--            <h2>Quản lý người dùng</h2>-->
<!--            <button>Thêm người dùng mới</button>-->
<!--            &lt;!&ndash; Thêm các chức năng admin khác &ndash;&gt;-->
<!--        </div>-->

<!--        &lt;!&ndash; Ví dụ nội dung user &ndash;&gt;-->
<!--        <div th:if="${userRole == 'USER'}" class="user-section">-->
<!--            <h2>Thông tin cá nhân</h2>-->
<!--            <p>Chỉnh sửa thông tin, xem lịch sử sự kiện, ...</p>-->
<!--            &lt;!&ndash; Nội dung user &ndash;&gt;-->
<!--        </div>-->
    </div>
</div>

<!-- Background Particles và Animation nếu muốn có thể để lại hoặc tách riêng -->

<div class="background-particles" th:if="${userRole == null}">
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
</div>

<div class="background-animation" th:if="${userRole == null}">
    <div class="floating-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
        <div class="shape shape-4"></div>
        <div class="shape shape-5"></div>
    </div>
</div>

<!-- Toast Notification -->
<div id="toast" class="toast glass">
    <i class="toast-icon"></i>
    <span class="toast-message"></span>
</div>

<!--<script th:src="@{/js/login.js}"></script>-->
<script th:src="@{/js/login.js(v=${#dates.createNow().time})}"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    let errorMessage = /*[[${error}]]*/ null;
    if (errorMessage !== null && errorMessage.trim() !== "") {
        showToast(errorMessage, 'error');
    }
    /*]]>*/
</script>

</body>
</html>
